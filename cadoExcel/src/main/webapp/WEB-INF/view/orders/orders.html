<#include "../include/header.html">
<body>
	<script>
	var  viewModel = kendo.observable({
	    model: {
	    	
	    },
	    ordersDetail:function(orderNo){
	    	 var url="./item/orders_detail.html?orderNo="+orderNo;
	    	 var dialog =  $("#dialog").kendoWindow({
	             	actions: [ "Maximize", "Minimize", "Close"],
	                width: 800,
	                height: 200,
	                title: '查看详情', 
	                content: url,                  
	                iframe:  true,
	                visible: false,
	                modal:true,
	                close: function() {
	                }
	             }).data("kendoWindow");
	             dialog.center().open();
	    },
	    saveFunction: function(){
	    	 $("#grid").data('kendoGrid').saveChanges();
        }
	});
	
	
	</script>
	
	<div id="dialog"></div>
	<div id="page-content">
		<div class="pull-left" id="toolbar-btn" style="padding-bottom:10px;">
	        <span class="btn btn-success k-grid-save-changes"  style="float:left;margin-right:5px;" data-bind="click:saveFunction">保存</span>
	    </div>

	    <div class="pull-right" id="query-form" style="padding-bottom:10px;">
	        <input data-role="maskedtextbox" placeholder='银行反馈时间' type="text" style="width: 150px;float:left;margin-right:5px;" data-bind="value:model.name" class="k-textbox">
	        <span class="btn btn-primary" style="float:left;width:70px" data-bind="click:queryFunction" type="submit">查询</span>
	        <div style="clear:both"></div>
	    </div>

	    <div style="clear:both">
        	<div id="grid"></div>
   		</div>
	</div>

	<script>
	
	kendo.bind($('#page-content'), viewModel);


	dataSource = new kendo.data.DataSource(
                {
                    transport: {
                        read: {
                            url: '${base.contextPath}/orders/item/query',
                            type: "GET",
                            dataType: "json"
                        },
                        update      : {
                            url        :"${base.contextPath}/orders/item/submit",
                            contentType: "application/json",
                            type       : "POST"
                        },
                        parameterMap: function (options, type) {
                        	if (type !== "read" && options.models) {
                                var datas = HTed.prepareSubmitParameter(options, type);
                                return kendo.stringify(datas);
                            } else if (type === "read") {
                                return HTed.prepareQueryParameter(viewModel.model.toJSON(), options);
                            }
                        }
                    },
                    batch: true,
                    serverPaging: true,
                    pageSize: 10,
                    schema: {
                        data: 'rows',
                        total: 'total',
                        model: {
                            id: "configId",
                            fields:{}
                        }
                    }
});

var grid = $("#grid").kendoGrid({
    dataSource: dataSource,
    navigatable: false,
    resizable: true,
    scrollable: true,
    rownumber: false,
    pageable: {
        pageSizes: [1,5, 10, 20, 50],
        refresh: true,
        buttonCount: 1
    },
    columns: [
    	{field: "orderNo", title: '订单编号', width: 80},
        {field: "aeModel", title: '型号', width: 80},
        {field: "afOrderAttribute", title: '订单属性', width: 80},
        {field: "agLogisticsName", title: '物流名称', width: 80},
        {field: "ahLogisticsNo", title: '物流单号', width: 80},
        {field: "aiDeliveryTime", title: '发货时间', width: 80},
        {field: "ajBz", title: '备注说明', width: 80},
        {field: "akOrderBatch", title: '订单批次', width: 80},
        {
        	title: '操作',
        	width: 80 ,
            headerAttributes: {
                "class": "table-header-cell",
                style: "text-align: center"
            },
            template:function(e){
               return "<a href=\"javascript:void(0)\" onclick=\"viewModel.ordersDetail(\'"+e.orderNo+"\')\">查看明细</a>";
        	}
        }
    ],
    editable   : true
}).data("kendoGrid");

HTed.autoResizeGrid("#grid"); 
</script>

</body>